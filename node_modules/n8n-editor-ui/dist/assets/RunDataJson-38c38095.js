import{h as b,_ as P}from"./n8n-91a817dd.js";import{V as f}from"./vue-json-pretty-cfc4ef1d.js";import{e as v,c as j,n as k,d as J,f as N,j as S,s as M,i as E,k as $}from"./index-683d9781.js";import"./axios-706baf85.js";import{m as A}from"./pinia-b59a3de7.js";import{M as T}from"./MappingPill-63fb3cab.js";import{d as V,y as p,aD as C,b as r,o as s,f as i,c as d,w as o,k as c,aE as I,e as u,g as F,n as m,t as l}from"./vendor-c8bad0e4.js";import"./luxon-19e1de07.js";import"./esprima-next-8c7e8ff9.js";import"./lodash-es-876af2e5.js";import"./@fortawesome/vue-fontawesome-6e8401ca.js";import"./@fortawesome/fontawesome-svg-core-984d6dde.js";import"./flatted-8b14da7d.js";import"./vue-i18n-6b44b0b1.js";import"./dateformat-ce9c2f3c.js";import"./@jsplumb/browser-ui-70b0a0d6.js";import"./@jsplumb/core-0a463c13.js";import"./@jsplumb/util-98a92a84.js";import"./@jsplumb/common-fe415eb9.js";import"./@jsplumb/connector-bezier-53998944.js";import"./uuid-cf522c50.js";import"./@n8n/codemirror-lang-sql-9a304659.js";import"./codemirror-lang-n8n-expression-47e67c3a.js";import"./codemirror-lang-html-n8n-4223f8c7.js";import"./fast-json-stable-stringify-44009db8.js";import"./prettier-8be78f6f.js";import"./@vueuse/core-5943aedd.js";import"./timeago.js-a9e71aec.js";import"./file-saver-cc6d9044.js";import"./humanize-duration-b7379348.js";import"./v3-infinite-loading-ff016886.js";import"./vue-agile-b5edbe38.js";import"./copy-to-clipboard-4501bff5.js";import"./vue3-touch-events-ee55ce04.js";import"./@fortawesome/free-solid-svg-icons-c96f0de9.js";import"./@fortawesome/free-regular-svg-icons-74cb85f8.js";const w=C(async()=>b(()=>import("./RunDataJsonActions-47c4ebc6.js"),["assets/RunDataJsonActions-47c4ebc6.js","assets/pinia-b59a3de7.js","assets/n8n-91a817dd.js","assets/luxon-19e1de07.js","assets/esprima-next-8c7e8ff9.js","assets/vendor-c8bad0e4.js","assets/lodash-es-876af2e5.js","assets/@fortawesome/vue-fontawesome-6e8401ca.js","assets/@fortawesome/fontawesome-svg-core-984d6dde.js","assets/n8n-def62baf.css","assets/jsonpath-fb833cd3.js","assets/index-683d9781.js","assets/axios-706baf85.js","assets/flatted-8b14da7d.js","assets/vue-i18n-6b44b0b1.js","assets/dateformat-ce9c2f3c.js","assets/@jsplumb/browser-ui-70b0a0d6.js","assets/@jsplumb/core-0a463c13.js","assets/@jsplumb/util-98a92a84.js","assets/@jsplumb/common-fe415eb9.js","assets/@jsplumb/connector-bezier-53998944.js","assets/uuid-cf522c50.js","assets/@n8n/codemirror-lang-sql-9a304659.js","assets/codemirror-lang-n8n-expression-47e67c3a.js","assets/codemirror-lang-html-n8n-4223f8c7.js","assets/fast-json-stable-stringify-44009db8.js","assets/prettier-8be78f6f.js","assets/@vueuse/core-5943aedd.js","assets/timeago.js-a9e71aec.js","assets/file-saver-cc6d9044.js","assets/vue-json-pretty-cfc4ef1d.js","assets/humanize-duration-b7379348.js","assets/v3-infinite-loading-ff016886.js","assets/vue-agile-b5edbe38.js","assets/vue-agile-d964f598.css","assets/copy-to-clipboard-4501bff5.js","assets/vue3-touch-events-ee55ce04.js","assets/@fortawesome/free-solid-svg-icons-c96f0de9.js","assets/@fortawesome/free-regular-svg-icons-74cb85f8.js","assets/index-ac404141.css","assets/RunDataJsonActions-698bad68.css"])),R=V({name:"run-data-json",mixins:[v],components:{VueJsonPretty:f,Draggable:j,RunDataJsonActions:w,MappingPill:T},props:{editMode:{type:Object},sessionId:{type:String},paneType:{type:String},node:{type:Object},inputData:{type:Array},mappingEnabled:{type:Boolean},distanceFromActive:{type:Number},runIndex:{type:Number},totalRuns:{type:Number}},setup(){const e=p(k),a=p(null),n=p("json");return{selectedJsonPath:e,draggingPath:a,displayMode:n}},computed:{...A(N,J),jsonData(){return S(this.inputData)}},methods:{getShortKey(e){return e?M(e.dataset.name||"",16,2):""},getJsonParameterPath(e){const a=e.replace(/^(\["?\d"?])/,"");return E({nodeName:this.node.name,distanceFromActive:this.distanceFromActive,path:a})},onDragStart(e){e&&e.dataset.path&&(this.draggingPath=e.dataset.path),this.ndvStore.resetMappingTelemetry()},onDragEnd(e){this.draggingPath=null,setTimeout(()=>{const a=this.ndvStore.mappingTelemetry,n={src_node_type:this.node.type,src_field_name:e.dataset.name||"",src_nodes_back:this.distanceFromActive,src_run_index:this.runIndex,src_runs_total:this.totalRuns,src_field_nest_level:e.dataset.depth||0,src_view:"json",src_element:e,success:!1,...a};this.$externalHooks().run("runDataJson.onDragEnd",n),this.$telemetry.track("User dragged data for mapping",n)},1e3)},getContent(e){return $(e)?`"${e}"`:JSON.stringify(e)},getListItemName(e){return e.replace(/^(\["?\d"?]\.?)/g,"")}}}),B="_jsonDisplay_5i0kz_5",z="_mappable_5i0kz_25",K="_dragged_5i0kz_32",L={jsonDisplay:B,mappable:z,dragged:K};const O=["data-value","data-name","data-path","data-depth"],H={key:0},U=["data-value","data-name","data-path","data-depth"];function W(e,a,n,G,Q,X){const h=r("run-data-json-actions"),y=r("MappingPill"),_=r("vue-json-pretty"),D=r("draggable");return s(),i("div",{class:m(e.$style.jsonDisplay)},[(s(),d(I,null,{default:o(()=>[e.editMode.enabled?c("",!0):(s(),d(h,{key:0,node:e.node,sessioId:e.sessionId,displayMode:e.displayMode,distanceFromActive:e.distanceFromActive,selectedJsonPath:e.selectedJsonPath,jsonData:e.jsonData,paneType:e.paneType},null,8,["node","sessioId","displayMode","distanceFromActive","selectedJsonPath","jsonData","paneType"]))]),_:1})),u(D,{type:"mapping",targetDataKey:"mappable",disabled:!e.mappingEnabled,onDragstart:e.onDragStart,onDragend:e.onDragEnd},{preview:o(({canDrop:t,el:g})=>[g?(s(),d(y,{key:0,html:e.getShortKey(g),"can-drop":t},null,8,["html","can-drop"])):c("",!0)]),default:o(()=>[u(_,{data:e.jsonData,deep:10,showLength:!0,selectedValue:e.selectedJsonPath,rootPath:"",selectableType:"single",class:"json-data","onUpdate:selectedValue":a[0]||(a[0]=t=>e.selectedJsonPath=t)},{renderNodeKey:o(({node:t})=>[F("span",{"data-target":"mappable","data-value":e.getJsonParameterPath(t.path),"data-name":t.key,"data-path":t.path,"data-depth":t.level,class:m({[e.$style.mappable]:e.mappingEnabled,[e.$style.dragged]:e.draggingPath===t.path})},'"'+l(t.key)+'"',11,O)]),renderNodeValue:o(({node:t})=>[isNaN(t.index)?(s(),i("span",H,l(e.getContent(t.content)),1)):(s(),i("span",{key:1,"data-target":"mappable","data-value":e.getJsonParameterPath(t.path),"data-name":e.getListItemName(t.path),"data-path":t.path,"data-depth":t.level,class:m([{[e.$style.mappable]:e.mappingEnabled,[e.$style.dragged]:e.draggingPath===t.path},"ph-no-capture"])},l(e.getContent(t.content)),11,U))]),_:1},8,["data","selectedValue"])]),_:1},8,["disabled","onDragstart","onDragend"])],2)}const q={$style:L},Ve=P(R,[["render",W],["__cssModules",q]]);export{Ve as default};
//# sourceMappingURL=RunDataJson-38c38095.js.map
