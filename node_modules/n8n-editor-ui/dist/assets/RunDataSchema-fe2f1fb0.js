import"./axios-706baf85.js";import{s as M,i as w,l as I,f as K,m as V,o as B,p as N,c as R,q as C,r as W,t as j}from"./index-683d9781.js";import{_ as S}from"./n8n-91a817dd.js";import{d as F,i as p,b as E,o as s,f as n,n as r,g as P,e as T,t as g,k as l,M as z,a9 as q,c as v,V as H,y as J,w as D,l as L,j as U}from"./vendor-c8bad0e4.js";import{M as G}from"./MappingPill-63fb3cab.js";import"./pinia-b59a3de7.js";import"./flatted-8b14da7d.js";import"./vue-i18n-6b44b0b1.js";import"./@fortawesome/vue-fontawesome-6e8401ca.js";import"./@fortawesome/fontawesome-svg-core-984d6dde.js";import"./dateformat-ce9c2f3c.js";import"./lodash-es-876af2e5.js";import"./luxon-19e1de07.js";import"./@jsplumb/browser-ui-70b0a0d6.js";import"./@jsplumb/core-0a463c13.js";import"./@jsplumb/util-98a92a84.js";import"./@jsplumb/common-fe415eb9.js";import"./@jsplumb/connector-bezier-53998944.js";import"./uuid-cf522c50.js";import"./@n8n/codemirror-lang-sql-9a304659.js";import"./codemirror-lang-n8n-expression-47e67c3a.js";import"./codemirror-lang-html-n8n-4223f8c7.js";import"./fast-json-stable-stringify-44009db8.js";import"./prettier-8be78f6f.js";import"./esprima-next-8c7e8ff9.js";import"./@vueuse/core-5943aedd.js";import"./timeago.js-a9e71aec.js";import"./file-saver-cc6d9044.js";import"./vue-json-pretty-cfc4ef1d.js";import"./humanize-duration-b7379348.js";import"./v3-infinite-loading-ff016886.js";import"./vue-agile-b5edbe38.js";import"./copy-to-clipboard-4501bff5.js";import"./vue3-touch-events-ee55ce04.js";import"./@fortawesome/free-solid-svg-icons-c96f0de9.js";import"./@fortawesome/free-regular-svg-icons-74cb85f8.js";const O=["title"],Q=["data-value","data-name","data-path","data-depth"],X={key:0},Y=["id"],Z=["for"],x=F({__name:"RunDataSchemaItem",props:{schema:{},level:{},parent:{},subKey:{},paneType:{},mappingEnabled:{type:Boolean},draggingPath:{},distanceFromActive:{},node:{}},setup(b){const a=b,o=p(()=>Array.isArray(a.schema.value)),m=p(()=>{var e;return((e=a.parent)==null?void 0:e.type)==="array"}),_=p(()=>a.level===0&&Array.isArray(a.schema.value)&&a.schema.value.every(e=>!Array.isArray(e.value))),d=p(()=>m.value?`[${a.schema.key}]`:a.schema.key),u=p(()=>m.value?`${a.schema.type}[${a.schema.key}]`:a.schema.key),y=p(()=>Array.isArray(a.schema.value)?"":M(a.schema.value,600,0)),k=e=>w({nodeName:a.node.name,distanceFromActive:a.distanceFromActive,path:e}),f=e=>`${e*.033}s`,t=e=>{switch(e){case"object":return"cube";case"array":return"list";case"string":case"null":return"font";case"number":return"hashtag";case"boolean":return"check-square";case"function":return"code";case"bigint":return"calculator";case"symbol":return"sun";case"undefined":return"ban"}I(e)};return(e,c)=>{const i=E("font-awesome-icon"),h=E("run-data-schema-item",!0);return s(),n("div",{class:r(e.$style.item),"data-test-id":"run-data-schema-item"},[e.level>0||e.level===0&&!o.value?(s(),n("div",{key:0,title:e.schema.type,class:r({[e.$style.pill]:!0,[e.$style.mappable]:e.mappingEnabled,[e.$style.dragged]:e.draggingPath===e.schema.path})},[P("span",{class:r(e.$style.label),"data-value":k(e.schema.path),"data-name":u.value,"data-path":e.schema.path,"data-depth":e.level,"data-target":"mappable"},[T(i,{icon:t(e.schema.type),size:"sm"},null,8,["icon"]),m.value?(s(),n("span",X,g(e.parent.key),1)):l("",!0),d.value?(s(),n("span",{key:1,class:r({[e.$style.arrayIndex]:m.value})},g(d.value),3)):l("",!0)],10,Q)],10,O)):l("",!0),y.value?(s(),n("span",{key:1,class:r(e.$style.text)},g(y.value),3)):l("",!0),e.level>0&&o.value?(s(),n("input",{key:2,id:e.subKey,type:"checkbox",checked:""},null,8,Y)):l("",!0),e.level>0&&o.value?(s(),n("label",{key:3,class:r(e.$style.toggle),for:e.subKey},[T(i,{icon:"angle-up"})],10,Z)):l("",!0),o.value?(s(),n("div",{key:4,class:r({[e.$style.sub]:!0,[e.$style.flat]:_.value})},[(s(!0),n(z,null,q(e.schema.value,($,A)=>(s(),v(h,{key:`${$.type}-${e.level}-${A}`,schema:$,level:e.level+1,parent:e.schema,paneType:e.paneType,subKey:`${e.paneType}_${$.type}-${e.level}-${A}`,mappingEnabled:e.mappingEnabled,draggingPath:e.draggingPath,distanceFromActive:e.distanceFromActive,node:e.node,style:H({transitionDelay:f(A)})},null,8,["schema","level","parent","paneType","subKey","mappingEnabled","draggingPath","distanceFromActive","node","style"]))),128))],2)):l("",!0)],2)}}}),ee="_item_dk8yb_5",ae="_sub_dk8yb_18",te="_toggle_dk8yb_24",se="_flat_dk8yb_45",ne="_pill_dk8yb_55",re="_mappable_dk8yb_74",oe="_dragged_dk8yb_82",le="_label_dk8yb_93",pe="_arrayIndex_dk8yb_98",me="_text_dk8yb_104",ie={item:ee,sub:ae,toggle:te,flat:se,pill:ne,mappable:re,dragged:oe,label:le,arrayIndex:pe,text:me},ce={$style:ie},de=S(x,[["__cssModules",ce]]),ue=F({__name:"RunDataSchema",props:{data:{},mappingEnabled:{type:Boolean},distanceFromActive:{default:0},runIndex:{},totalRuns:{},paneType:{},node:{}},setup(b){const a=b,o=J(""),m=K(),_=V(),{getSchemaForExecutionData:d}=C(),u=p(()=>d(a.data)),y=p(()=>B(a.data)),k=t=>{var e;t&&((e=t.dataset)!=null&&e.path)&&(o.value=t.dataset.path),m.resetMappingTelemetry()},f=t=>{o.value="",setTimeout(()=>{var i;const e=m.mappingTelemetry,c={src_node_type:(i=a.node)==null?void 0:i.type,src_field_name:t.dataset.name||"",src_nodes_back:a.distanceFromActive,src_run_index:a.runIndex,src_runs_total:a.totalRuns,src_field_nest_level:t.dataset.depth||0,src_view:"schema",src_element:t,success:!1,...e};W("runDataJson.onDragEnd",_,c),j.track("User dragged data for mapping",c)},1e3)};return(t,e)=>{const c=E("n8n-info-tip");return s(),n("div",{class:r(t.$style.schemaWrapper)},[y.value?(s(),v(c,{key:0},{default:D(()=>[L(g(U(N).baseText("dataMapping.schemaView.emptyData")),1)]),_:1})):(s(),v(R,{key:1,type:"mapping",targetDataKey:"mappable",disabled:!t.mappingEnabled,onDragstart:k,onDragend:f},{preview:D(({canDrop:i,el:h})=>[h?(s(),v(G,{key:0,html:h.outerHTML,"can-drop":i},null,8,["html","can-drop"])):l("",!0)]),default:D(()=>[P("div",{class:r(t.$style.schema)},[T(de,{schema:u.value,level:0,parent:null,paneType:t.paneType,subKey:`${u.value.type}-0-0`,mappingEnabled:t.mappingEnabled,draggingPath:o.value,distanceFromActive:t.distanceFromActive,node:t.node},null,8,["schema","paneType","subKey","mappingEnabled","draggingPath","distanceFromActive","node"])],2)]),_:1},8,["disabled"]))],2)}}}),ye="_schemaWrapper_1j9mn_5",he="_schema_1j9mn_5",ge={schemaWrapper:ye,schema:he},ve={$style:ge},ea=S(ue,[["__cssModules",ve]]);export{ea as default};
//# sourceMappingURL=RunDataSchema-fe2f1fb0.js.map
