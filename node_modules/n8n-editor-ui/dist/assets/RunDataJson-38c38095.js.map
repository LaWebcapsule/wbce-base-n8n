{"version":3,"mappings":"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","names":["RunDataJsonActions","defineAsyncComponent","__vitePreload","_sfc_main","defineComponent","externalHooks","VueJsonPretty","Draggable","MappingPill","selectedJsonPath","ref","nonExistingJsonPath","draggingPath","displayMode","mapStores","useNDVStore","useWorkflowsStore","executionDataToJson","el","shorten","path","subPath","getMappedExpression","mappingTelemetry","telemetryPayload","value","isString","_resolveComponent","_ctx","_createBlock","_Suspense","_withCtx","_openBlock","_component_run_data_json_actions","_component_draggable","canDrop","_component_MappingPill","_createCommentVNode","_createVNode","_component_vue_json_pretty","_cache","$event","node","_createElementVNode","_normalizeClass","_toDisplayString","_hoisted_1","_createElementBlock","_hoisted_2"],"sources":["../../src/components/RunDataJson.vue"],"sourcesContent":["<template>\n\t<div :class=\"$style.jsonDisplay\">\n\t\t<Suspense>\n\t\t\t<run-data-json-actions\n\t\t\t\tv-if=\"!editMode.enabled\"\n\t\t\t\t:node=\"node\"\n\t\t\t\t:sessioId=\"sessionId\"\n\t\t\t\t:displayMode=\"displayMode\"\n\t\t\t\t:distanceFromActive=\"distanceFromActive\"\n\t\t\t\t:selectedJsonPath=\"selectedJsonPath\"\n\t\t\t\t:jsonData=\"jsonData\"\n\t\t\t\t:paneType=\"paneType\"\n\t\t\t/>\n\t\t</Suspense>\n\t\t<draggable\n\t\t\ttype=\"mapping\"\n\t\t\ttargetDataKey=\"mappable\"\n\t\t\t:disabled=\"!mappingEnabled\"\n\t\t\t@dragstart=\"onDragStart\"\n\t\t\t@dragend=\"onDragEnd\"\n\t\t>\n\t\t\t<template #preview=\"{ canDrop, el }\">\n\t\t\t\t<MappingPill v-if=\"el\" :html=\"getShortKey(el)\" :can-drop=\"canDrop\" />\n\t\t\t</template>\n\t\t\t<vue-json-pretty\n\t\t\t\t:data=\"jsonData\"\n\t\t\t\t:deep=\"10\"\n\t\t\t\t:showLength=\"true\"\n\t\t\t\t:selectedValue=\"selectedJsonPath\"\n\t\t\t\trootPath=\"\"\n\t\t\t\tselectableType=\"single\"\n\t\t\t\tclass=\"json-data\"\n\t\t\t\t@update:selectedValue=\"selectedJsonPath = $event\"\n\t\t\t>\n\t\t\t\t<template #renderNodeKey=\"{ node }\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-target=\"mappable\"\n\t\t\t\t\t\t:data-value=\"getJsonParameterPath(node.path)\"\n\t\t\t\t\t\t:data-name=\"node.key\"\n\t\t\t\t\t\t:data-path=\"node.path\"\n\t\t\t\t\t\t:data-depth=\"node.level\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t[$style.mappable]: mappingEnabled,\n\t\t\t\t\t\t\t[$style.dragged]: draggingPath === node.path,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\t>\"{{ node.key }}\"</span\n\t\t\t\t\t>\n\t\t\t\t</template>\n\t\t\t\t<template #renderNodeValue=\"{ node }\">\n\t\t\t\t\t<span v-if=\"isNaN(node.index)\">{{ getContent(node.content) }}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tdata-target=\"mappable\"\n\t\t\t\t\t\t:data-value=\"getJsonParameterPath(node.path)\"\n\t\t\t\t\t\t:data-name=\"getListItemName(node.path)\"\n\t\t\t\t\t\t:data-path=\"node.path\"\n\t\t\t\t\t\t:data-depth=\"node.level\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t[$style.mappable]: mappingEnabled,\n\t\t\t\t\t\t\t[$style.dragged]: draggingPath === node.path,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\tclass=\"ph-no-capture\"\n\t\t\t\t\t\t>{{ getContent(node.content) }}</span\n\t\t\t\t\t>\n\t\t\t\t</template>\n\t\t\t</vue-json-pretty>\n\t\t</draggable>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineAsyncComponent, defineComponent, ref } from 'vue';\nimport type { PropType } from 'vue';\nimport VueJsonPretty from 'vue-json-pretty';\nimport type { IDataObject, INodeExecutionData } from 'n8n-workflow';\nimport Draggable from '@/components/Draggable.vue';\nimport { executionDataToJson, isString, shorten } from '@/utils';\nimport type { INodeUi } from '@/Interface';\nimport { externalHooks } from '@/mixins/externalHooks';\nimport { mapStores } from 'pinia';\nimport { useNDVStore } from '@/stores/ndv.store';\nimport MappingPill from './MappingPill.vue';\nimport { getMappedExpression } from '@/utils/mappingUtils';\nimport { useWorkflowsStore } from '@/stores/workflows.store';\nimport { nonExistingJsonPath } from '@/constants';\n\nconst RunDataJsonActions = defineAsyncComponent(\n\tasync () => import('@/components/RunDataJsonActions.vue'),\n);\n\nexport default defineComponent({\n\tname: 'run-data-json',\n\tmixins: [externalHooks],\n\tcomponents: {\n\t\tVueJsonPretty,\n\t\tDraggable,\n\t\tRunDataJsonActions,\n\t\tMappingPill,\n\t},\n\tprops: {\n\t\teditMode: {\n\t\t\ttype: Object as () => { enabled?: boolean; value?: string },\n\t\t},\n\t\tsessionId: {\n\t\t\ttype: String,\n\t\t},\n\t\tpaneType: {\n\t\t\ttype: String,\n\t\t},\n\t\tnode: {\n\t\t\ttype: Object as PropType<INodeUi>,\n\t\t},\n\t\tinputData: {\n\t\t\ttype: Array as PropType<INodeExecutionData[]>,\n\t\t},\n\t\tmappingEnabled: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tdistanceFromActive: {\n\t\t\ttype: Number,\n\t\t},\n\t\trunIndex: {\n\t\t\ttype: Number,\n\t\t},\n\t\ttotalRuns: {\n\t\t\ttype: Number,\n\t\t},\n\t},\n\tsetup() {\n\t\tconst selectedJsonPath = ref(nonExistingJsonPath);\n\t\tconst draggingPath = ref<null | string>(null);\n\t\tconst displayMode = ref('json');\n\n\t\treturn {\n\t\t\tselectedJsonPath,\n\t\t\tdraggingPath,\n\t\t\tdisplayMode,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useNDVStore, useWorkflowsStore),\n\t\tjsonData(): IDataObject[] {\n\t\t\treturn executionDataToJson(this.inputData);\n\t\t},\n\t},\n\tmethods: {\n\t\tgetShortKey(el: HTMLElement): string {\n\t\t\tif (!el) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn shorten(el.dataset.name || '', 16, 2);\n\t\t},\n\t\tgetJsonParameterPath(path: string): string {\n\t\t\tconst subPath = path.replace(/^(\\[\"?\\d\"?])/, ''); // remove item position\n\n\t\t\treturn getMappedExpression({\n\t\t\t\tnodeName: this.node.name,\n\t\t\t\tdistanceFromActive: this.distanceFromActive,\n\t\t\t\tpath: subPath,\n\t\t\t});\n\t\t},\n\t\tonDragStart(el: HTMLElement) {\n\t\t\tif (el && el.dataset.path) {\n\t\t\t\tthis.draggingPath = el.dataset.path;\n\t\t\t}\n\n\t\t\tthis.ndvStore.resetMappingTelemetry();\n\t\t},\n\t\tonDragEnd(el: HTMLElement) {\n\t\t\tthis.draggingPath = null;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst mappingTelemetry = this.ndvStore.mappingTelemetry;\n\t\t\t\tconst telemetryPayload = {\n\t\t\t\t\tsrc_node_type: this.node.type,\n\t\t\t\t\tsrc_field_name: el.dataset.name || '',\n\t\t\t\t\tsrc_nodes_back: this.distanceFromActive,\n\t\t\t\t\tsrc_run_index: this.runIndex,\n\t\t\t\t\tsrc_runs_total: this.totalRuns,\n\t\t\t\t\tsrc_field_nest_level: el.dataset.depth || 0,\n\t\t\t\t\tsrc_view: 'json',\n\t\t\t\t\tsrc_element: el,\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\t...mappingTelemetry,\n\t\t\t\t};\n\n\t\t\t\tvoid this.$externalHooks().run('runDataJson.onDragEnd', telemetryPayload);\n\n\t\t\t\tthis.$telemetry.track('User dragged data for mapping', telemetryPayload);\n\t\t\t}, 1000); // ensure dest data gets set if drop\n\t\t},\n\t\tgetContent(value: unknown): string {\n\t\t\treturn isString(value) ? `\"${value}\"` : JSON.stringify(value);\n\t\t},\n\t\tgetListItemName(path: string): string {\n\t\t\treturn path.replace(/^(\\[\"?\\d\"?]\\.?)/g, '');\n\t\t},\n\t},\n});\n</script>\n\n<style lang=\"scss\" module>\n.jsonDisplay {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tpadding-left: var(--spacing-s);\n\tright: 0;\n\toverflow-y: auto;\n\tline-height: 1.5;\n\tword-break: normal;\n\theight: 100%;\n\tpadding-bottom: var(--spacing-3xl);\n\tbackground-color: var(--color-background-base);\n\n\t&:hover {\n\t\t/* Shows .actionsGroup element from <run-data-json-actions /> child component */\n\t\t> div:first-child {\n\t\t\topacity: 1;\n\t\t}\n\t}\n}\n\n.mappable {\n\tcursor: grab;\n\n\t&:hover {\n\t\tbackground-color: var(--color-json-highlight);\n\t}\n}\n\n.dragged {\n\t&,\n\t&:hover {\n\t\tbackground-color: var(--color-primary-tint-2);\n\t}\n}\n</style>\n\n<style lang=\"scss\">\n.vjs-tree {\n\tcolor: var(--color-json-default);\n}\n\n.vjs-tree-node {\n\t&:hover {\n\t\tbackground-color: transparent;\n\t}\n\n\t&.is-highlight {\n\t\tbackground-color: var(--color-json-highlight);\n\t}\n}\n\n.vjs-key,\n.vjs-value {\n\t> span {\n\t\tcolor: var(--color-text-dark);\n\t\tline-height: 1.7;\n\t\tborder-radius: var(--border-radius-base);\n\t}\n}\n\n.vjs-value {\n\t> span {\n\t\tpadding: 0 var(--spacing-5xs) 0 var(--spacing-5xs);\n\t\tmargin-left: var(--spacing-5xs);\n\t}\n}\n\n.vjs-tree .vjs-value-null {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-null);\n\t}\n}\n\n.vjs-tree .vjs-value-boolean {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-boolean);\n\t}\n}\n\n.vjs-tree .vjs-value-number {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-number);\n\t}\n}\n\n.vjs-tree .vjs-value-string {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-string);\n\t}\n}\n\n.vjs-tree .vjs-key {\n\tcolor: var(--color-json-key);\n}\n\n.vjs-tree .vjs-tree__brackets {\n\tcolor: var(--color-json-brackets);\n}\n\n.vjs-tree .vjs-tree__brackets:hover {\n\tcolor: var(--color-json-brackets-hover);\n}\n\n.vjs-tree .vjs-tree__content.has-line {\n\tborder-left: 1px dotted var(--color-json-line);\n}\n</style>\n"],"file":"assets/RunDataJson-38c38095.js"}